# Probabilistic Roadmap for motion planning of a fire Truck

## About the project

Implement a planner that utilizes two forms of motion planning algorithms to navigate a firetruck through a cluttered, maze-like environment. Test two types of motion planning algorithms, first a combinatorial search algorithm, specifically A* or a variant, and then a Probabilistic RoadMap planner. The firetruck must plan paths to the most important fire to fight, as fires spread, and new fires get started.

## About the environment

The environment consists of a flat square field, 250 meters on a side, filled with obstacles. The obstacles consist of large patches of un-navigable thick brush, trees, and weeds, suspiciously shaped like giant tetrominoes. While the environment is not specifically a grid, the base dimension for each obstacle square unit is 15 meters. Inside this field, a firetruck operates, attempting to extinguish fires that emerge.

Starting at time 0 and at 10 second intervals, a major conflagration is set at a random obstacle. This sets the obstacle state to burning. This obstacle sets all obstacles withing 30 meter radius to the state of burning.

The truck starts at a random point in the map. If the truck stops within 10 meters of a burning obstacle, it sets the state to extinguished.

A snapshot of the firetruck extinguishing fire is shown below:

![environment_snapshot](https://github.com/kt-krutarthtrivedi/Motion-Planner-For-Firetrucks/assets/134632027/e7ace01e-bc20-4d29-9193-a0c8ed147fb2)


## Planners used:
The above problem statement is implemented using two different planners and their results are compared. The following planners were used:
### Combinatorial Planner (A-Star) :
The combinatorial planner consists of A-Star Algorithm with some additional penalties for reverse. The effect of the penalty is quite visible in the simulation as the truck avoids travel in reverse direction and takes a longer circular route to reach the goal point. Since the environment is simulated in a grid world using pygame, the entire simulation is pixelated, as evident in the video, due to which the truck fails to maintain its rectangular shape most of the times.





https://github.com/kt-krutarthtrivedi/Motion-Planner-For-Firetrucks/assets/134632027/a700a45a-7062-4702-af3e-e333ac7007f2

&nbsp;



### Sampling based Planner (Probabilistic Roadmap):
The sampling based planner consists of constructing a Probabilistic Roadmap. A total of 100 nodes were randomly selected for constructing the Roadmap. The Configruation Space was initially divided into free space and obstacle space. The nodes were sampled in free space, and the edges were generated by determining the collision free paths. To identify the edges, the nearest neighbour approach using the kd-tree is implemented in python. The feasibile path for the global planner is calculated using the A-Star Algotithm without non-holonomic constraints. Then a fast local planner is implemented between the nodes identified by the global planner. For this project, A-Star algorithm with non-holonomic constraints is implemented. With some modifications, an aritificial potential field can also be implemented for the local planner instead of the A-Star planner.

An example of a probabilistic Road Map is shown below:

<img width="526" alt="Screenshot 2023-05-27 at 8 42 55 PM" src="https://github.com/kt-krutarthtrivedi/Motion-Planner-For-Firetrucks/assets/134632027/fb36ffe8-a17e-4c53-b073-b01af6068be7">

&nbsp;



https://github.com/kt-krutarthtrivedi/Motion-Planner-For-Firetrucks/assets/134632027/57251b0a-f4b9-496a-86f3-bcc1265a69c9






## Results of Comparison of both planners

The extinguished to burned ratio indicates how fast a planner responds to a burning world. As seen in the figure below, the ratio is higher for the PRM Planner than the A-Star Planner, indicating a better suitability for this scenario.

<img width="628" alt="Screenshot 2023-05-27 at 8 45 16 PM" src="https://github.com/kt-krutarthtrivedi/Motion-Planner-For-Firetrucks/assets/134632027/2f620f44-5a68-4f12-847d-ae7d0cbdb964">


&nbsp;


Here is a graph on the computational time required for running a 3 minute simulation. As per the data below, the computational resource utilized by the PRM Planner is lesser than the A-Star. 

<img width="628" alt="Screenshot 2023-05-27 at 8 46 05 PM" src="https://github.com/kt-krutarthtrivedi/Motion-Planner-For-Firetrucks/assets/134632027/3a1a4179-ad63-45a2-855d-23731ef96fba">


&nbsp;

From my understanding, I would say that given certain relatively weak conditions on the shape of the free space, PRM is provably probabilistically complete, meaning that as the number of sampled points increases without bound, the probability that the algorithm will not find a path if one exists approaches zero. The rate of convergence depends on certain visibility properties of the free space, where visibility is determined by the local planner. Roughly, if each point can "see" a large fraction of the space, and also if a large fraction of each subset of the space can "see" a large fraction of its complement, then the planner will find a path quickly. Hence, having a PRM will definitely help to find the “complete” solution unless otherwise not possible.


# References

* [Steven M. LaValle. Planning Algorithms. Cambridge University Press, May 2006.
9780521862059.](http://lavalle.pl/planning/)
* https://demonstrations.wolfram.com/ProbabilisticRoadmapMethod/

